# 小红书监控器 GUI 使用指南

## 目录
- [快速开始](#快速开始)
- [功能特性](#功能特性)
- [使用流程](#使用流程)
- [界面说明](#界面说明)
- [常见问题](#常见问题)

---

## 快速开始

### 1. 安装依赖

```bash
# 安装 Python 依赖
pip3 install -r requirements.txt

# macOS 用户如遇到 tkinter 错误
brew install python-tk
```

### 2. 启动 GUI

```bash
# 方式 1: 使用启动脚本
python3 run_xhs_monitor_gui.py

# 方式 2: 直接运行
python3 xhs_monitor_gui.py
```

### 3. 首次使用

首次运行时会提示添加账号：

1. 点击 **"添加账号"** 按钮
2. 输入小红书账号和密码
3. 系统会生成主密码 (请妥善保管)
4. 添加完成后点击 **"开始监控"**

---

## 功能特性

### ✅ 账号管理
- **多账号支持**: 添加多个小红书账号
- **自动轮换**: 智能选择最佳账号进行搜索
- **密码加密**: AES-256 加密存储，安全可靠
- **状态追踪**: 实时监控账号健康状态

### ✅ 自动登录
- **记住登录**: 首次登录后自动保存状态
- **无感登录**: 后续使用自动登录，无需手动输入
- **失效检测**: 自动检测登录状态失效并重新登录

### ✅ 搜索监控
- **多关键词**: 支持批量搜索多个关键词
- **时间过滤**: 支持最近 1 天/3 天/1 周等时间范围
- **自动采集**: 自动收集帖子和评论数据
- **数据导出**: 支持 JSON 和 CSV 格式导出

### ✅ 安全防护
- **拟人化行为**: 模拟真实用户的鼠标和键盘操作
- **指纹伪装**: 浏览器指纹随机化
- **反检测**: 集成最新反爬虫技术
- **冷却机制**: 账号自动冷却，避免过度使用

---

## 使用流程

### 步骤 1: 添加账号

1. 启动 GUI 界面
2. 点击 **"添加账号"** 按钮
3. 填写账号信息:
   - 账号 (手机号/邮箱)
   - 密码
   - 手机号 (可选)
   - 备注 (可选)
4. 点击 **"保存"**

**首次添加账号时**:
- 系统会生成随机主密码
- 请复制并妥善保管主密码
- 主密码丢失后无法恢复账号

### 步骤 2: 配置搜索

1. 在 **"关键词"** 文本框输入要搜索的关键词
   - 每行一个关键词
   - 示例:
     ```
     GEO 优化
     AI 搜索排名
     品牌获客
     ```

2. 选择 **"时间范围"**:
   - 最近 1 天
   - 最近 3 天
   - 最近 1 周 (推荐)
   - 最近 2 周
   - 最近 1 个月

3. 设置 **"高级选项"**:
   - 每关键词最大帖子数 (默认 30)
   - 是否提取评论 (推荐勾选)
   - 无头模式 (后台运行，不显示浏览器)

### 步骤 3: 开始监控

1. 选择要使用的账号:
   - 从下拉列表选择特定账号
   - 或选择 **"自动轮换"** (推荐)

2. 点击 **"开始监控"** 按钮

3. 观察运行状态:
   - 实时日志显示
   - 进度条更新
   - 统计数据变化

4. 等待完成:
   - 监控完成后会弹出提示
   - 结果自动保存到 `xhs_browser_data` 目录

### 步骤 4: 查看结果

1. 点击 **"打开结果目录"** 按钮
2. 查看生成的文件:
   - `monitor_result_*.json` - 完整数据
   - `export_posts_*.csv` - 帖子数据
   - `export_comments_*.csv` - 评论数据

---

## 界面说明

### 主界面布局

```
┌────────────────────────────────────────────┐
│ 菜单栏                                     │
│  [文件] [账号管理] [帮助]                  │
├────────────────────────────────────────────┤
│ 账号配置                                   │
│ 选择账号：[下拉框] [刷新] [添加账号]       │
│ ☑ 启用自动轮换 (推荐)                      │
├────────────────────────────────────────────┤
│ 搜索配置                                   │
│ 关键词：[文本框，每行一个]                 │
│ 时间范围：[下拉框]                         │
│ ☑ 提取评论  ☐ 无头模式                     │
├────────────────────────────────────────────┤
│ [开始监控] [停止监控] [清空日志]           │
│ ████████████░░░░░░░░ 进度条                │
├────────────────────────────────────────────┤
│ 运行状态                                   │
│ 当前状态：运行中  已处理关键词：3          │
│ 已收集帖子：150  已收集评论：450           │
├────────────────────────────────────────────┤
│ 运行日志                                   │
│ [10:30:15] 开始监控...                     │
│ [10:30:20] 使用账号：138****8000           │
│ [10:30:25] 搜索关键词：GEO 优化             │
│ ...                                        │
└────────────────────────────────────────────┘
```

### 状态指示

| 状态 | 颜色 | 说明 |
|-----|------|------|
| 就绪 | 🟢 绿色 | 可以开始监控 |
| 运行中 | 🔵 蓝色 | 监控任务正在进行 |
| 已完成 | 🟢 绿色 | 监控任务完成 |
| 已停止 | 🟠 橙色 | 用户手动停止 |
| 错误 | 🔴 红色 | 发生错误 |

### 账号状态图标

| 图标 | 状态 | 说明 |
|-----|------|------|
| ✅ | active | 正常，可以使用 |
| ⚠️ | suspicious | 可疑，需要观察 |
| 🚫 | limited | 受限，搜索被限制 |
| ❌ | banned | 封禁，无法使用 |
| ❓ | unknown | 未知，首次使用 |

---

## 常见问题

### Q1: 首次使用提示输入主密码？

**A**: 主密码用于加密存储的账号密码，是保护账号安全的第一道防线。

- 首次添加账号时会自动生成随机主密码
- 请复制并妥善保管 (建议存入密码管理器)
- 主密码丢失后无法恢复账号密码
- 每次启动程序需要输入主密码解密账号

### Q2: 自动登录失败怎么办？

**A**: 自动登录可能因为滑块验证失败，这是正常现象。

解决方案:
1. 第一次登录时手动完成验证
2. 登录状态会被保存
3. 后续使用会自动使用保存的状态
4. 如状态失效，会再次提示手动登录

### Q3: 如何添加更多账号？

**A**: 有三种方式:

1. **GUI 界面**: 点击"添加账号"按钮
2. **命令行**: `python3 xhs_account_manager.py add`
3. **批量导入**: 编辑 `xhs_accounts.yaml` 文件

### Q4: 自动轮换是如何工作的？

**A**: 自动轮换会根据以下因素选择账号:

- 账号状态 (优先选择 active)
- 使用次数 (优先选择使用少的)
- 冷却时间 (跳过 1 小时内使用过的)
- 失败次数 (跳过连续失败 3 次以上的)

### Q5: 监控完成后结果保存在哪里？

**A**: 结果保存在 `xhs_browser_data` 目录:

```
xhs_browser_data/
├── monitor_result_20260217_103000.json  # 完整数据
├── export_posts_20260217_103000.csv     # 帖子数据
├── export_comments_20260217_103000.csv  # 评论数据
└── posts/                                # 按关键词分类
    └── posts_GEO 优化_20260217_103000.json
```

### Q6: 如何导出/导入配置？

**A**: 

**导出配置**:
1. 配置好关键词和选项
2. 点击"文件" → "导出配置"
3. 保存为 `.json` 文件

**导入配置**:
1. 点击"文件" → "导入配置"
2. 选择之前导出的 `.json` 文件
3. 配置自动填充

### Q7: 无头模式是什么？

**A**: 无头模式 (Headless) 是后台运行模式:

- ✅ 优点：不显示浏览器窗口，占用资源少
- ❌ 缺点：无法看到运行过程，调试困难
- 推荐：首次使用不要勾选，熟悉后可启用

### Q8: 账号被限制了怎么办？

**A**: 如果账号状态变为 limited:

1. 暂停使用该账号 24-48 小时
2. 手动登录账号，正常浏览小红书
3. 进行一些真人互动 (点赞、收藏、评论)
4. 之后在 GUI 中右键账号 → "重置状态"

### Q9: 如何查看账号统计？

**A**: 有三种方式:

1. **GUI 界面**: 账号列表下方显示统计信息
2. **命令行**: `python3 xhs_account_manager.py status`
3. **查看文件**: `xhs_accounts.yaml`

### Q10: 程序卡住不动怎么办？

**A**: 可能的原因和解决方案:

1. **网络问题**: 检查网络连接
2. **验证码**: 查看浏览器窗口，可能需要手动完成验证
3. **页面加载慢**: 等待一段时间
4. **程序错误**: 点击"停止监控"，查看日志错误信息

---

## 快捷键

| 快捷键 | 功能 |
|-------|------|
| `Ctrl+N` | 添加账号 |
| `Ctrl+S` | 开始监控 |
| `Ctrl+K` | 停止监控 |
| `Ctrl+L` | 清空日志 |
| `Ctrl+O` | 打开结果目录 |
| `F1` | 显示帮助 |
| `Esc` | 关闭对话框 |

---

## 技术支持

### 日志位置

程序运行日志保存在:
- GUI 日志：界面下方实时显示
- 文件日志：`xhs_browser_data/logs/`

### 调试模式

启用调试模式查看详细日志:

```bash
# 设置环境变量
export XHS_DEBUG=1

# 运行程序
python3 run_xhs_monitor_gui.py
```

### 反馈问题

遇到问题请提供:
1. 错误日志 (从界面复制)
2. 操作步骤 (如何复现)
3. 系统信息 (操作系统、Python 版本)

---

**文档版本**: v2.0  
**更新时间**: 2026-02-17  
**相关文档**: ACCOUNT_MANAGER_README.md, ANTI_DETECTION_README.md
